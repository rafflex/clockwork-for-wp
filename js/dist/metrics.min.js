!function(){"use strict";var t,e,n=function(t){return{name:t,value:arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,delta:0,entries:[],id:"".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),isFinal:!1}},i=function(t,e){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var n=new PerformanceObserver((function(t){return t.getEntries().map(e)}));return n.observe({type:t,buffered:!0}),n}}catch(t){}},a=!1,r=!1,s=function(t){a=!t.persisted},o=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r||(addEventListener("pagehide",s),addEventListener("beforeunload",(function(){})),r=!0),addEventListener("visibilitychange",(function(e){var n=e.timeStamp;"hidden"===document.visibilityState&&t({timeStamp:n,isUnloading:a})}),{capture:!0,once:e})},c=function(t,e,n,i){var a;return function(){n&&e.isFinal&&n.disconnect(),e.value>=0&&(i||e.isFinal||"hidden"===document.visibilityState)&&(e.delta=e.value-(a||0),(e.delta||e.isFinal||void 0===a)&&(t(e),a=e.value))}},l=function(){return void 0===t&&(t="hidden"===document.visibilityState?0:1/0,o((function(e){var n=e.timeStamp;return t=n}),!0)),{get timeStamp(){return t}}},u=function(){return e||(e=new Promise((function(t){return["scroll","keydown","pointerdown"].map((function(e){addEventListener(e,t,{once:!0,passive:!0,capture:!0})}))}))),e};let d=new class{constructor(t={}){t={...this.payload(),...t},this.enabled=t.metrics,this.requestId=t.requestId,this.path=t.path||"/__clockwork/",this.updateToken=t.token,this.metrics={redirect:null,dns:null,connection:null,waiting:null,downloading:null,domLoading:null,domInteractive:null},this.vitals={cls:null,fid:null,lcp:null,fcp:null,ttfb:null}}collectMetrics(){this.enabled&&document.addEventListener("readystatechange",(t=>{if("complete"!=document.readyState)return;let e=window.performance.timing;this.updateMetrics({redirect:e.redirectEnd-e.redirectStart,dns:e.domainLookupEnd-e.domainLookupStart,connection:e.connectEnd-e.connectStart,waiting:e.responseStart-e.requestStart,receiving:e.responseEnd-e.responseStart,domInteractive:e.domInteractive-e.domLoading,domComplete:e.domComplete-e.domInteractive})}))}collectVitals(){this.enabled&&(function(t){var e,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n("CLS",0),s=function(t){t.hadRecentInput||(r.value+=t.value,r.entries.push(t),e())},l=i("layout-shift",s);l&&(e=c(t,r,l,a),o((function(t){var n=t.isUnloading;l.takeRecords().map(s),n&&(r.isFinal=!0),e()})))}((t=>this.updateVitals("cls",t.value))),function(t){var e=n("FID"),a=l(),r=function(t){t.startTime<a.timeStamp&&(e.value=t.processingStart-t.startTime,e.entries.push(t),e.isFinal=!0,u())},s=i("first-input",r),u=c(t,e,s);s?o((function(){s.takeRecords().map(r),s.disconnect()}),!0):window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&window.perfMetrics.onFirstInputDelay((function(t,n){n.timeStamp<a.timeStamp&&(e.value=t,e.isFinal=!0,e.entries=[{entryType:"first-input",name:n.type,target:n.target,cancelable:n.cancelable,startTime:n.timeStamp,processingStart:n.timeStamp+t}],u())}))}((t=>this.updateVitals("fid",t.value))),function(t){var e,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n("LCP"),s=l(),d=function(t){var n=t.startTime;n<s.timeStamp?(r.value=n,r.entries.push(t)):r.isFinal=!0,e()},p=i("largest-contentful-paint",d);if(p){e=c(t,r,p,a);var m=function(){r.isFinal||(p.takeRecords().map(d),r.isFinal=!0,e())};u().then(m),o(m,!0)}}((t=>this.updateVitals("lcp",t.value))),function(t){var e,a=n("FCP"),r=l(),s=i("paint",(function(t){"first-contentful-paint"===t.name&&t.startTime<r.timeStamp&&(a.value=t.startTime,a.isFinal=!0,a.entries.push(t),e())}));s&&(e=c(t,a,s))}((t=>this.updateVitals("fcp",t.value))),function(t){var e,i=n("TTFB");e=function(){try{var e=performance.getEntriesByType("navigation")[0]||function(){var t=performance.timing,e={entryType:"navigation",startTime:0};for(var n in t)"navigationStart"!==n&&"toJSON"!==n&&(e[n]=Math.max(t[n]-t.navigationStart,0));return e}();i.value=i.delta=e.responseStart,i.entries=[e],i.isFinal=!0,t(i)}catch(t){}},"complete"===document.readyState?setTimeout(e,0):addEventListener("pageshow",e)}((t=>this.updateVitals("ttfb",t.value))))}payload(){let t=document.cookie.match(/(?:^| )x-clockwork=([^;]*)/);return t?JSON.parse(decodeURIComponent(t[1])):{}}updateMetrics(t){Object.assign(this.metrics,t),this.send()}updateVitals(t,e){this.vitals[t]=e,this.send()}send(){clearTimeout(this.timeout),this.timeout=setTimeout((()=>{fetch(`${this.path}${this.requestId}`,{method:"post",headers:new Headers({"X-HTTP-Method-Override":"PUT"}),body:JSON.stringify({_token:this.updateToken,clientMetrics:this.metrics,webVitals:this.vitals})})}),500)}};d.collectMetrics(),d.collectVitals()}();
